"use strict";(()=>{var e={};e.id=6553,e.ids=[6553],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4536:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>g,patchFetch:()=>L,requestAsyncStorage:()=>_,routeModule:()=>m,serverHooks:()=>h,staticGenerationAsyncStorage:()=>N});var l={};a.r(l),a.d(l,{GET:()=>f,dynamic:()=>p});var o=a(49303),r=a(88716),n=a(60670),s=a(87070),i=a(42633),d=a(48645),u=a(60938),c=a(57745);let p="force-dynamic";async function f(e){try{let e=await i.db.select({count:(0,u.QX)()}).from(d.Reports),t=await i.db.select({count:(0,u.QX)()}).from(d.CollectedWastes).where((0,c.eq)(d.CollectedWastes.status,"collected")),a=await i.db.select({count:(0,u.QX)()}).from(d.Reports).where((0,c.eq)(d.Reports.status,"completed")),l=await i.db.select({count:(0,u.QX)()}).from(d.Users),o=e[0]?.count||0,r=t[0]?.count||0,n=a[0]?.count||0,p=l[0]?.count||0,f=2*n+5*r,m={totalReports:o,totalTasks:r,totalUsers:p,totalWasteCollected:Math.round(10*f)/10,totalCO2Saved:Math.round(.5*f*10)/10,lastUpdated:new Date().toISOString()},_=s.NextResponse.json(m);return _.headers.set("Cache-Control","no-store, no-cache, must-revalidate, proxy-revalidate"),_.headers.set("Pragma","no-cache"),_.headers.set("Expires","0"),_}catch(e){return s.NextResponse.json({error:"Failed to fetch platform stats",totalReports:0,totalTasks:0,totalUsers:0,totalWasteCollected:0,totalCO2Saved:0},{status:500})}}let m=new o.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/admin/stats/route",pathname:"/api/admin/stats",filename:"route",bundlePath:"app/api/admin/stats/route"},resolvedPagePath:"C:\\Users\\devan\\Downloads\\zero2hero-Waste-Management-System-master\\src\\app\\api\\admin\\stats\\route.ts",nextConfigOutput:"",userland:l}),{requestAsyncStorage:_,staticGenerationAsyncStorage:N,serverHooks:h}=m,g="/api/admin/stats/route";function L(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:N})}},42633:(e,t,a)=>{a.d(t,{db:()=>s});var l=a(17917),o=a(62237),r=a(48645);let n=(0,o.qn)("postgresql://neondb_owner:Devansh%4077@ep-weathered-waterfall-a16ci7i1-pooler.ap-southeast-1.aws.neon.tech/neondb?sslmode=require"),s=(0,l.tS)(n,{schema:r})},48645:(e,t,a)=>{a.r(t),a.d(t,{CollectedWastes:()=>m,Notifications:()=>_,Reports:()=>p,Rewards:()=>f,Transactions:()=>N,Users:()=>c,WasteCollectionTasks:()=>g,available_rewards:()=>h,collectedWaste:()=>y,notifications:()=>b,reports:()=>w,rewards:()=>v,transactions:()=>A,users:()=>L,wasteCollectionTasks:()=>P});var l=a(23733),o=a(95961),r=a(41401),n=a(12941),s=a(1575),i=a(72140),d=a(98748),u=a(28680);let c=(0,l.af)("users",{id:(0,o.eP)("id").primaryKey(),name:(0,r.L7)("name",{length:255}).notNull(),email:(0,r.L7)("email",{length:255}).notNull().unique(),password:(0,r.L7)("password",{length:255}),firebaseUid:(0,r.L7)("firebase_uid",{length:255}).unique(),authProvider:(0,r.L7)("auth_provider",{length:20}).default("email").notNull(),balance:(0,n._L)("balance").default(0).notNull(),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow(),image:(0,i.fL)("image"),publicProfileVisible:(0,d.O7)("public_profile_visible").default(!0).notNull(),profileSearchable:(0,d.O7)("profile_searchable").default(!0).notNull(),showRealName:(0,d.O7)("show_real_name").default(!1).notNull(),personalStatsVisible:(0,d.O7)("personal_stats_visible").default(!0).notNull(),dataSharing:(0,r.L7)("data_sharing",{length:20}).default("anonymous").notNull(),environmentalTracking:(0,d.O7)("environmental_tracking").default(!0).notNull(),collectionHistoryRetention:(0,r.L7)("collection_history_retention",{length:20}).default("1year").notNull()}),p=(0,l.af)("reports",{id:(0,o.eP)("id").primaryKey(),userId:(0,n._L)("user_id").references(()=>c.id),location:(0,i.fL)("location").notNull(),wasteType:(0,r.L7)("waste_type",{length:255}).notNull(),amount:(0,r.L7)("amount",{length:255}).notNull(),imageUrl:(0,i.fL)("image_url"),verificationResult:(0,u.JB)("verification_result"),status:(0,r.L7)("status",{length:255}).notNull().default("pending"),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),collectorId:(0,n._L)("collector_id").references(()=>c.id)}),f=(0,l.af)("rewards",{id:(0,o.eP)("id").primaryKey(),userId:(0,n._L)("user_id").references(()=>c.id).notNull(),points:(0,n._L)("points").notNull().default(0),level:(0,n._L)("level").notNull().default(1),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at").defaultNow().notNull(),isAvailable:(0,d.O7)("is_available").notNull().default(!0),description:(0,i.fL)("description"),name:(0,r.L7)("name",{length:255}).notNull(),collectionInfo:(0,i.fL)("collection_info").notNull()}),m=(0,l.af)("collected_wastes",{id:(0,o.eP)("id").primaryKey(),reportId:(0,n._L)("report_id").references(()=>p.id).notNull(),collectorId:(0,n._L)("collector_id").references(()=>c.id).notNull(),collectionDate:(0,s.AB)("collection_date").notNull(),status:(0,r.L7)("status",{length:20}).notNull().default("collected"),amount:(0,r.L7)("amount",{length:255}),verificationResult:(0,u.JB)("verification_result")}),_=(0,l.af)("notifications",{id:(0,o.eP)("id").primaryKey(),userId:(0,n._L)("user_id").references(()=>c.id).notNull(),message:(0,i.fL)("message").notNull(),type:(0,r.L7)("type",{length:50}).notNull(),isRead:(0,d.O7)("is_read").notNull().default(!1),imageUrl:(0,i.fL)("image_url"),metadata:(0,u.JB)("metadata"),createdAt:(0,s.AB)("created_at").defaultNow().notNull()}),N=(0,l.af)("transactions",{id:(0,o.eP)("id").primaryKey(),userId:(0,n._L)("user_id").references(()=>c.id).notNull(),type:(0,r.L7)("type",{length:20}).notNull(),amount:(0,n._L)("amount").notNull(),description:(0,i.fL)("description").notNull(),date:(0,s.AB)("date").defaultNow().notNull()}),h=(0,l.af)("available_rewards",{id:(0,o.eP)("id").primaryKey(),name:(0,r.L7)("name",{length:255}).notNull(),description:(0,i.fL)("description"),points_required:(0,n._L)("points_required").notNull(),level_required:(0,n._L)("level_required").notNull(),created_at:(0,s.AB)("created_at").defaultNow().notNull(),updated_at:(0,s.AB)("updated_at").defaultNow().notNull()}),g=(0,l.af)("waste_collection_tasks",{id:(0,o.eP)("id").primaryKey(),createdBy:(0,n._L)("created_by").references(()=>c.id).notNull(),location:(0,i.fL)("location").notNull(),description:(0,i.fL)("description"),status:(0,r.L7)("status",{length:20}).default("active").notNull(),createdAt:(0,s.AB)("created_at").defaultNow().notNull(),completedAt:(0,s.AB)("completed_at")}),L=c,w=p,v=f,y=m,b=_,A=N,P=g},60938:(e,t,a)=>{a.d(t,{QX:()=>o,Sm:()=>r});var l=a(62315);function o(e){return(0,l.i6)`count(${e||l.i6.raw("*")})`.mapWith(Number)}function r(e){return(0,l.i6)`sum(${e})`.mapWith(String)}}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),l=t.X(0,[8948,5972,7917],()=>a(4536));module.exports=l})();