"use strict";(()=>{var e={};e.id=3002,e.ids=[3002],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},5538:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>w,patchFetch:()=>f,requestAsyncStorage:()=>x,routeModule:()=>m,serverHooks:()=>g,staticGenerationAsyncStorage:()=>h});var s={};r.r(s),r.d(s,{POST:()=>c});var a=r(49303),i=r(88716),n=r(60670),o=r(87070),u=r(42633),d=r(48645),l=r(57745),p=r(2310);async function c(e){try{let{name:t,email:r,password:s}=await e.json();if(!r||!s)return o.NextResponse.json({error:"Validation failed",details:{email:r?void 0:"Email is required",password:s?void 0:"Password is required"}},{status:422});if(!r.includes("@"))return o.NextResponse.json({error:"Validation failed",details:{email:"Invalid email format"}},{status:422});let[a]=await u.db.select({id:d.Users.id}).from(d.Users).where((0,l.eq)(d.Users.email,r));if(a)return o.NextResponse.json({error:"Email already registered"},{status:409});try{let e=await (0,p.c_)(s),[a]=await u.db.insert(d.Users).values({name:t||r.split("@")[0],email:r,password:e,createdAt:new Date}).returning({id:d.Users.id,email:d.Users.email,name:d.Users.name});if(!a?.id)throw Error("Failed to create user - no ID returned");let i=(0,p.V3)({id:a.id}),n=o.NextResponse.json({user:{id:a.id,email:a.email,name:a.name}},{status:201});return n.cookies.set("auth_token",i,{httpOnly:!0,secure:!0,sameSite:"lax",path:"/",maxAge:2592e3}),n}catch(e){throw e}}catch(e){return o.NextResponse.json({error:"Failed to create account",details:e instanceof Error?e.message:"Unknown error occurred"},{status:500})}}let m=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"C:\\Users\\devan\\Downloads\\zero2hero-Waste-Management-System-master\\src\\app\\api\\auth\\register\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:x,staticGenerationAsyncStorage:h,serverHooks:g}=m,w="/api/auth/register/route";function f(){return(0,n.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:h})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[8948,5972,7917,2310],()=>r(5538));module.exports=s})();